(.venv) (base) PS D:\Projects\AI\Street> python .\claude6.py
__name__: __main__

=========== Training Model: efficientnetv2_rw_m ===========
Epoch 1/35
  0%|                                                                                          | 0/937 [00:00<?, ?it/s]Initial lr: 5.000000000000002e-05
After first step lr: 5.00002180785496e-05
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [01:00<00:00, 15.39it/s]
Start Evaluation
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:56<00:00,  2.68it/s]
Validation accuracy: 0.0000
Epoch 2/35
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:39<00:00, 23.62it/s]
Start Evaluation
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:48<00:00,  2.90it/s]
Validation accuracy: 0.0000
Epoch 3/35
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:44<00:00, 21.06it/s]
Start Evaluation
Val Acc: 0.00:  35%|██████████████████████▍                                          | 108/313 [00:33<01:03,  3.25it/s]
Traceback (most recent call last):
  File "D:\Projects\AI\Street\claude6.py", line 966, in <module>
    trainer.train()
    ~~~~~~~~~~~~~^^
  File "D:\Projects\AI\Street\claude6.py", line 530, in train
    val_acc = self.eval()
  File "D:\Projects\AI\Street\claude6.py", line 659, in eval
    pred = self.tta_predict(img)
  File "D:\Projects\AI\Street\claude6.py", line 699, in tta_predict
    pred_crop = self.model(img_crop)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\Projects\AI\Street\claude6.py", line 301, in forward
    feat = self.backbone(img)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\timm\models\efficientnet.py", line 268, in forward
    x = self.forward_features(x)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\timm\models\efficientnet.py", line 256, in forward_features
    x = self.blocks(x)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\timm\models\_efficientnet_blocks.py", line 287, in forward
    x = self.bn1(x)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\timm\layers\norm_act.py", line 115, in forward
    x = F.batch_norm(
        x,
    ...<7 lines>...
        self.eps,
    )
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\nn\functional.py", line 2822, in batch_norm
    return torch.batch_norm(
           ~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
    ...<7 lines>...
        torch.backends.cudnn.enabled,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
KeyboardInterrupt
Exception ignored in atexit callback <function _MultiProcessingDataLoaderIter._clean_up_worker at 0x0000023760A4CE00>:
Traceback (most recent call last):
  File "D:\Projects\AI\Street\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 1612, in _clean_up_worker
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "C:\Users\fqt15\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "C:\Users\fqt15\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\popen_spawn_win32.py", line 114, in wait
    res = _winapi.WaitForSingleObject(int(self._handle), msecs)
KeyboardInterrupt:
(.venv) (base) PS D:\Projects\AI\Street> python .\claude6.py > new_claude_train.log
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [01:06<00:00, 14.14it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:55<00:00,  2.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.47it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.36it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  2.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.42it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:45<00:00,  2.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.36it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:45<00:00,  2.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.40it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.48it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:45<00:00,  2.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.27it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  2.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.35it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:40<00:00,  3.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:37<00:00, 24.69it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:40<00:00,  3.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:37<00:00, 24.87it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:43<00:00,  3.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.64it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.39it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.53it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:40<00:00,  3.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:37<00:00, 24.69it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:43<00:00,  3.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.31it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  2.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.56it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.50it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.39it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.41it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.16it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:43<00:00,  3.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:37<00:00, 24.70it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:43<00:00,  3.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.21it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.30it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:43<00:00,  3.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.27it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.32it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.37it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:40<00:00,  3.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:37<00:00, 24.75it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:43<00:00,  3.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.51it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.40it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:43<00:00,  3.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.32it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.40it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.34it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:38<00:00, 24.40it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:44<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [00:47<00:00, 19.71it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [01:47<00:00,  2.92it/s]
model.safetensors: 100%|████████████████████████████████████████████████████████████| 354M/354M [01:40<00:00, 3.51MB/s]
D:\Projects\AI\Street\.venv\Lib\site-packages\huggingface_hub\file_download.py:144: UserWarning: `huggingface_hub` cache-system uses symlinks by default to efficiently store duplicated files but your machine does not support them in C:\Users\fqt15\.cache\huggingface\hub\models--timm--convnext_base.fb_in22k_ft_in1k. Caching files will still work but in a degraded version that might require more space on your disk. This warning can be disabled by setting the `HF_HUB_DISABLE_SYMLINKS_WARNING` environment variable. For more details, see https://huggingface.co/docs/huggingface_hub/how-to-cache#limitations.
To support symlinks on Windows, you either need to activate Developer Mode or to run Python as an administrator. In order to activate developer mode, see this article: https://docs.microsoft.com/en-us/windows/apps/get-started/enable-your-device-for-development
  warnings.warn(message)
100%|████████████████████████████████████████████████████████████████████████████████| 937/937 [01:03<00:00, 14.68it/s]
Val Acc: 0.00: 100%|█████████████████████████████████████████████████████████████████| 313/313 [03:13<00:00,  1.62it/s]
 58%|██████████████████████████████████████████████                                  | 540/937 [00:34<00:16, 24.35it/s]